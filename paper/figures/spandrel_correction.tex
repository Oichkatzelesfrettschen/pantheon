% Spandrel Stiffness Correction Visualization
% Shows how epsilon modifies the distance modulus

\begin{tikzpicture}
    \begin{axis}[
        width=0.95\columnwidth,
        height=5.5cm,
        xlabel={Redshift $z$},
        ylabel={$\Delta\mu_\varepsilon$ (mag)},
        xmin=0, xmax=2.5,
        ymin=-0.05, ymax=0.25,
        grid=major,
        grid style={gridgray, thin},
        legend pos=north west,
        legend style={draw=none, fill=white, fill opacity=0.9},
    ]

    % Î›CDM baseline (zero)
    \addplot[
        datablack,
        dashed,
        thick
    ] coordinates {(0, 0) (2.5, 0)};

    % Spandrel correction curves for different epsilon
    \addplot[
        cosmoblue,
        very thick,
        smooth,
        domain=0:2.5,
        samples=60
    ] {0.05 * x * ln(1+x)};

    \addplot[
        astrogreen,
        thick,
        smooth,
        domain=0:2.5,
        samples=60
    ] {0.1 * x * ln(1+x)};

    \addplot[
        detored,
        thick,
        smooth,
        domain=0:2.5,
        samples=60
    ] {0.15 * x * ln(1+x)};

    \addplot[
        nucpurple,
        thick,
        dashed,
        smooth,
        domain=0:2.5,
        samples=60
    ] {0.2 * x * ln(1+x)};

    \legend{
        $\Lambda$CDM ($\varepsilon = 0$),
        $\varepsilon = 0.05$,
        $\varepsilon = 0.10$,
        $\varepsilon = 0.15$,
        $\varepsilon = 0.20$
    }

    % Annotation for degeneracy
    \node[
        anchor=south west,
        draw=datablack,
        fill=white,
        fill opacity=0.9,
        inner sep=4pt,
        font=\footnotesize,
        align=left
    ] at (rel axis cs:0.55,0.15) {
        Degeneracy:\\
        $\varepsilon \leftrightarrow \Omega_\mathrm{m}$\\[2pt]
        $\Delta\chi^2 = 0.48$\\
        $p = 0.488$
    };

    % Arrow indicating degeneracy direction
    \draw[-{Stealth[length=2mm]}, thick, gray]
        (axis cs:1.8, 0.12) -- (axis cs:2.2, 0.18)
        node[midway, above, sloped, font=\tiny] {$\Omega_\mathrm{m}\uparrow$};

    \end{axis}
\end{tikzpicture}
